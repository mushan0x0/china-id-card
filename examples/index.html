<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>测试 - AMD</title>
  <link href="https://cdn.bootcss.com/bulma/0.5.1/css/bulma.min.css" rel="stylesheet">
  <script src="https://cdn.bootcss.com/require.js/2.3.5/require.min.js"></script>
  <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.slim.min.js"></script>
</head>
</head>

<body>

  <section class="hero">
    <div class="hero-body">
      <div class="columns is-centered">
        <div class="column is-half is-narrow">
          <div class="field">
            <label class="label">身份证号：</label>
            <div class="control">
              <input class="input" type="text" placeholder="ID Card Number" id="text">
            </div>
            <p class="help" id="tip" style="display:none"></p>
          </div>
          <div class="field is-grouped">
            <div class="control">
              <button class="button is-primary" id="check">检查</button>
            </div>
            <div class="control">
              <button class="button is-warning" id="reset">重置</button>
            </div>
            <div class="control">
              <button class="button " id="random">随机号码</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script>
    require(['../dist/index.amd.js'], function (IDCard) {
      var $text = $('#text'),
        $tip = $('#tip');
      var testList = [
        '622922197808118498',
        '37012519790112881X',
        '510726198609245808',
        '530629198901284967',
        '31000019850412412X',
      ];

      function toggleTip(type, message) {
        $text.removeClass('is-success is-danger');
        $tip.removeClass('is-success is-danger');
        if (
          type &&
          (/success|danger/i).test(type) &&
          message &&
          message.length
        ) {
          $text.addClass('is-' + type);
          $tip.addClass('is-' + type).text(message).show();
        } else {
          $tip.hide().text(null);
        }
      }

      $('#check').on('click', function () {
        var idCardNumber = $.trim($text.val());
        if (idCardNumber && idCardNumber.length) {
          var isVerified = IDCard.default(idCardNumber).isVerified;
          toggleTip(null, null);
          toggleTip(
            isVerified ? 'success' : 'danger',
            isVerified ? '身份证通过验证' : '身份证未能通过验证'
          );
        }
      });

      $('#reset').on('click', function () {
        $text.val(null);
        toggleTip(null, null);
      });

      $('#random').on('click', function () {
        toggleTip(null, null);
        $text.val(testList[Math.floor(Math.random() * (testList.length))]);
      });
    });
  </script>
</body>

</html>
